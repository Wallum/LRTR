//
//ProceduralParts fixes
//

PARTUPGRADE
{
    name = LRTRpostWarMaterialsScience
    cumulativeCost = true
    partIcon = proceduralTankLiquid
    techRequired = postWarMaterialsScience
    title = Procedural Tank (1.25)
    description = Procedural Tank min diameter 1.25
}
PARTUPGRADE
{
    name = LRTRearlyMaterialsScience
    partIcon = proceduralTankLiquid
    techRequired = earlyMaterialsScience
    title = Procedural Tank (0.625)
    description = Procedural Tank min diameter 0.625
}

PARTUPGRADE
{
    name = LRTRmaterialsScienceHuman
    partIcon = proceduralTankLiquid
    techRequired = materialsScienceHuman
    title = Procedural Tank (3.0)
    description = Procedural Tank max diameter is 3.0
}

PARTUPGRADE
{
    name = LRTRmaterialsScienceAdvCapsules
    partIcon = proceduralTankLiquid
    techRequired = materialsScienceAdvCapsules
    title = Procedural Tank (4.0)
    description = Procedural Tank max diameter is 4.0
}

PARTUPGRADE
{
    name = LRTRmaterialsScienceLunar
    partIcon = proceduralTankLiquid
    techRequired = materialsScienceLunar
    title = Procedural Tank (5.6)
    description = Procedural Tank max diameter is 5.6
}

PARTUPGRADE
{
    name = LRTRmaterialsScienceSpaceStation
    partIcon = proceduralTankLiquid
    techRequired = materialsScienceSpaceStation
    title = Procedural Tank (8.0)
    description = Procedural Tank max diameter is 8.0
}

PARTUPGRADE
{
    name = LRTRmaterialsScienceSpaceplanes
    partIcon = proceduralTankLiquid
    techRequired = materialsScienceSpaceplanes
    title = Procedural Tank (Unlimited)
    description = Procedural Tank max diameter is unlimited
}

PARTUPGRADE
{
    name = LRTRlifeSupportISRU
    partIcon = proceduralTankOre
    techRequired = lifeSupportISRU
    title = Procedural Ore Tank
    description = Procedural Ore Tank
}

PARTUPGRADE
{
    name = LRTRimprovedLifeSupport
    partIcon = proceduralTankOre
    techRequired = improvedLifeSupport
    title = Procedural Ore Tank (Expanded)
    description = Procedural Ore Tank dimensions are increased
}

PARTUPGRADE
{
    name = LRTRadvancedLifeSupport
    partIcon = proceduralTankOre
    techRequired = experimentalScience
    title = Procedural Ore Tank (Unlimited)
    description = Procedural Ore Tank dimensions are unlimited
}

PARTUPGRADE
{
    name = LRTRelectronicsSatellite
    partIcon = proceduralBattery
    techRequired = electronicsSatellite
    title = Procedural Battery (small)
    description = Procedural Batteries small
}

PARTUPGRADE
{
    name = LRTRelectronicsHuman
    partIcon = proceduralBattery
    techRequired = electronicsHuman
    title = Procedural Battery (medium)
    description = Procedural Batteries medium
}

PARTUPGRADE
{
    name = LRTRelectronicsLunar
    partIcon = proceduralBattery
    techRequired = electronicsLunar
    title = Procedural Battery (large)
    description = Procedural Batteries large
}

PARTUPGRADE
{
    name = LRTRelectronicsSpaceStation
    partIcon = proceduralBattery
    techRequired = electronicsSpaceStation
    title = Procedural Battery (huge)
    description = Procedural Batteries huge
}

PARTUPGRADE
{
    name = LRTRspaceStationSolarPanels
    partIcon = proceduralBattery
    techRequired = spaceStationSolarPanels
    title = Procedural Battery (unlimited)
    description = Procedural Batteries unlimited
}

PARTUPGRADE
{
    name = LRTRsupersonicFlightRP0
    partIcon = proceduralNoseCone
    techRequired = aerodynamicSystems
    title = Procedural NoseCone (small)
    description = Procedural NoseCone small
}

PARTUPGRADE
{
    name = LRTRhypersonicFlightRP0
    partIcon = proceduralNoseCone
    techRequired = aerodynamicSystems
    title = Procedural NoseCone (medium)
    description = Procedural NoseCone medium
}

PARTUPGRADE
{
    name = LRTRprototypeSpaceplanes
    partIcon = proceduralNoseCone
    techRequired = prototypeSpaceplanes
    title = Procedural NoseCone (large)
    description = Procedural NoseCone large
}

PARTUPGRADE
{
    name = LRTReffectiveSpaceplanes
    partIcon = proceduralNoseCone
    techRequired = effectiveSpaceplanes
    title = Procedural NoseCone (unlimited)
    description = Procedural NoseCone unlimited
}

PARTUPGRADE
{
    name = LRTRhumanRatedEDL
    partIcon = proceduralHeatshield
    techRequired = humanRatedEDL
    title = Procedural Heatshield (medium)
    description = Procedural Heatshield small
}

PARTUPGRADE
{
    name = LRTRearlyLanding
    partIcon = proceduralHeatshield
    techRequired = earlyLanding
    title = Procedural Heatshield (large)
    description = Procedural Heatshield maximum diameter is 3m
}

PARTUPGRADE
{
    name = LRTRlunarRatedHeatshields
    partIcon = proceduralHeatshield
    techRequired = lunarRatedHeatshields
    title = Procedural Heatshield (huge)
    description = Procedural Heatshield huge
}

PARTUPGRADE
{
    name = LRTRadvancedLanding
    partIcon = proceduralHeatshield
    techRequired = advancedLanding
    title = Procedural Heatshield (unlimited)
    description = Procedural Heatshield unlimited
}

PARTUPGRADE
{
    name = LRTRbasicSolids
    partIcon = proceduralTankSRB
    techRequired = basicSolids
    title = Procedural SRB (early)
    description = Procedural SRB early
}

PARTUPGRADE
{
    name = LRTRsolids1956
    partIcon = proceduralTankSRB
    techRequired = solids1956
    title = Procedural SRB (1956)
    description = Procedural SRB 1956
}

PARTUPGRADE
{
    name = LRTRsolids1958
    partIcon = proceduralTankSRB
    techRequired = solids1958
    title = Procedural SRB (1958)
    description = Procedural SRB 1958
}

PARTUPGRADE
{
    name = LRTRsolids1962
    partIcon = proceduralTankSRB
    techRequired = solids1962
    title = Procedural SRB (1962)
    description = Procedural SRB 1962
}

PARTUPGRADE
{
    name = LRTRsolids1964
    partIcon = proceduralTankSRB
    techRequired = solids1964
    title = Procedural SRB (1964)
    description = Procedural SRB 1964
}

PARTUPGRADE
{
    name = LRTRsolids1969
    partIcon = proceduralTankSRB
    techRequired = solids1969
    title = Procedural SRB (1969)
    description = Procedural SRB 1069
}

PARTUPGRADE
{
    name = LRTRsolids1972
    partIcon = proceduralTankSRB
    techRequired = solids1972
    title = Procedural SRB (unlimited)
    description = Procedural SRB unlimited
}


@PART[*]:HAS[@MODULE[ProceduralPart]]:BEFORE[zLRTR]
{
	MODULE
	{
		name = ModuleTagNotRescaled
	}
}

@PART[proceduralTankLiquid]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{

    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
        %diameterMin = 1.0
        %diameterMax = 1.25
        %lengthMin = 0.625
        %volumeMin = 0.5
        %lengthMax = 2.5
        
        -UPGRADES,* {} 
        
        UPGRADES {
            UPGRADE
            {
                name__ = LRTRpostWarMaterialsScience
                diameterMin = 1.0
                diameterMax = 1.25
                lengthMin = 0.625
                volumeMax = Infinity
                lengthMax = Infinity
            }
            UPGRADE
            {
                name__ = LRTRearlyMaterialsScience
                diameterMin = 0.5
                lengthMin = 0.3
                volumeMin = 0
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceHuman
                diameterMax = 1.875
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceAdvCapsules
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceLunar
                diameterMax = 3.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceStation
                diameterMax = 5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceplanes
                diameterMax = Infinity
            }
        }
    }
}

@PART[proceduralStructural]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
 
        %diameterMin = 1.0
        %diameterMax = 1.25
        %lengthMin = 0.625
        %volumeMin = 0.5
        %volumeMax = Infinity
        %lengthMax = Infinity
        
         -UPGRADES,* {} 

        UPGRADES {
            UPGRADE
            {
                name__ = LRTRearlyMaterialsScience
                diameterMin = 0.5
                lengthMin = 0.3
                volumeMin = 0
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceHuman
                diameterMax = 1.875
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceAdvCapsules
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceLunar
                diameterMax = 3.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceStation
                diameterMax = 5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceplanes
                diameterMax = Infinity
            }
        }
    }
}

@PART[proceduralTankOre]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {} 
        
        %diameterMin = 0.1
        %lengthMin = 0.1
        %volumeMin = 1.0
        
        UPGRADES
        {
           UPGRADE
            {
                name__ = LRTRlifeSupportISRU
                diameterMax = 1.5
                lengthMax = 1.75
                volumeMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRimprovedLifeSupport
                diameterMax = 3.5
                lengthMax = 5.0
                volumeMax = 15.0
            }
            UPGRADE
            {
                name__ = LRTRadvancedLifeSupport
			    diameterMin = 0.01
    			diameterMax = Infinity
	    		lengthMin = 0.01
		    	lengthMax = Infinity
			    volumeMin = 0.01
    			volumeMax = Infinity
            }
        }
    }
}

@PART[proceduralTankRCS]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        %diameterMin = 0.5
        %lengthMin = 0.3
        %volumeMin = 0.11
        
        UPGRADES
        {
            UPGRADE
            {
                name__ = LRTRmaterialsScienceAdvCapsules
                diameterMax = 2.5
                lengthMax = 2.0
                volumeMax = 5.0
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceStation
			    diameterMin = 0.01
    			diameterMax = Infinity
	    		lengthMin = 0.01
		    	lengthMax = Infinity
			    volumeMin = 0.01
    			volumeMax = Infinity
            }
        }
    }
}

@PART[proceduralTankXenon]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        %diameterMin = 0.125
        %diameterMax = 0.75
        %lengthMin = 0.1
        %lengthMax = 0.75
        %volumeMin = 0.02
        %volumeMax = 0.2
        
        UPGRADES
        {
            UPGRADE
            {
                name__ = LRTRadvancedElecPropulsion
                diameterMin = 0.01
                diameterMax = Infinity
                lengthMin = 0.01
                lengthMax = Infinity
                volumeMin = 0.01
                volumeMax = Infinity
            }
        }
    }
}

@PART[proceduralBattery]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{ 
    @MODULE[ProceduralShapeCone]
    {
        %techRequired = electronicsHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = electronicsAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = electronicsAdvCapsules
    }
        
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        UPGRADES {
           UPGRADE
           {
                name__ = LRTRelectronicsSatellite
                diameterMax = 0.5
                lengthMax = 1.0
                volumeMax = 0.05
            }
            UPGRADE
            {
                name__ = LRTRelectronicsHuman
                diameterMax = 1.25
                volumeMax = 0.08
            }
            UPGRADE
            {
                name__ = LRTRelectronicsLunar
                diameterMax = 1.875
                volumeMax = 0.16
            }
            UPGRADE
            {
                name__ = LRTRelectronicsSpaceStation
                diameterMax = 2.5
                volumeMax = 1.5
                maxLength = 1.25
            }
            UPGRADE
            {
                name__ = LRTRspaceStationSolarPanels
                diameterMin = 0.01
                diameterMax = Infinity
                lengthMin = 0.01
                lengthMax = Infinity
                volumeMin = 0.001
                volumeMax = Infinity
            }
        }
    }
}

@PART[proceduralNoseCone]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{         
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        UPGRADES
        {
            UPGRADE
            {
                name__ = LRTRsupersonicFlightRP0
                diameterMin = 0.125
                diameterMax = 1.25
                lengthMin = 0.625
                lengthMax = 0.625
            }
            UPGRADE
            {
                name__ = LRTRhypersonicFlightRP0
                lengthMax = 1.5
            }
            UPGRADE
            {
                name__ = LRTRprototypeSpaceplanes
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTReffectiveSpaceplanes
                diameterMin = 0.01
                diameterMax = Infinity
            }
        }
    }
}

@PART[proceduralHeatshield]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
         
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        UPGRADES
        {
            UPGRADE
            {
                name__ = LRTRhumanRatedEDL
                diameterMin = 0.5
                diameterMax = 1.25
            }
            UPGRADE
            {
                name__ = LRTRearlyLanding
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRlunarRatedHeatshields
                diameterMax = 3.5
            }
            UPGRADE 
            {
                name__ = LRTRadvancedLanding
                diameterMin = 0.01
                diameterMax = Infinity
                lengthMin = 0.1
                lengthMax = Infinity
                volumeMin = 0.01
                volumeMax = Infinity
            }
		}
    }
}

@PART[proceduralTankSRB]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{

    @MODULE[ProceduralShapeCone]
    {
        %techRequired = materialsScienceHuman
    }
    @MODULE[ProceduralShapePill]
    {
        %techRequired = materialsScienceAdvCapsules
    }
    @MODULE[ProceduralShapeBezierCone]
    {
        %techRequired = materialsScienceAdvCapsules
    }

    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
 		
 		%volumeMax = Infinity
        %diameterMin = 0.5
        %diameterMax = 0.5
        %lengthMin = 1.0
        %lengthMax = 1.25
        %volumeMin = 1.0
		
 		UPGRADES
 		{
            UPGRADE
            {
                name__ = LRTRbasicSolids
                diameterMax = 1.25
            }
            UPGRADE
            {
                name__ = LRTRsolids1956
                diameterMin = 0.1
                volumeMin = 0
                lengthMin = 0.5
            }
            UPGRADE
            {
                name__ = LRTRsolids1958
                lengthMax = 6.0
            }
            UPGRADE
            {
                name__ = LRTRsolids1962
                lengthMax = 14.0
            }
            UPGRADE
            {
                name__ = LRTRsolids1964
                diameterMax = 1.875
            }
            UPGRADE
            {
                name__ = LRTRsolids1969
                diameterMax = 2.5
            }
            UPGRADE 
            {
                name__ = LRTRsolids1972
                diameterMin = 0.01
                diameterMax = Infinity
                lengthMin = 0.1
                lengthMax = Infinity
                volumeMin = 0.01
            }
        }
    }
}

@PART[proceduralStackDecoupler]:NEEDS[LRTRTechTree]:BEFORE[zLRTR]
{
    @MODULE[ProceduralPart]
    {
        -UPGRADES,* {}
        
        UPGRADES
        {
            UPGRADE
            {
                name__ = LRTRearlyMaterialsScience
                diameterMin = 0.5
                diameterMax = 1.25
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceHuman
                diameterMax = 1.875
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceAdvCapsules
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceAdvCapsules
                diameterMax = 2.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceLunar
                diameterMax = 3.5
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceStation
                diameterMax = 5.0
            }
            UPGRADE
            {
                name__ = LRTRmaterialsScienceSpaceplanes
                diameterMax = Infinity
            }
        }
    }
    MODULE[DecouplerTweaker]
    {
        %separatorTechRequired = materialsScienceHuman
    }
}

@PART[*]:HAS[@MODULE[ProceduralPart]]:NEEDS[LRTRRescale]:BEFORE[zLRTR]
{
    @MODULE[TankContentSwitcher]
    {
        @TANK_TYPE_OPTION,*
        {
            @dryDensity *= 0.8
            @RESOURCE[SolidFuel]
            {
                @unitsPerT *= 1.6
            }
            @RESOURCE[MonoPropellant]
            {
                @unitsPerT *= 0.45
            }
        }
    }
    @MODULE[ProceduralPart]
    {
        @diameterMin *= 1.6
        @diameterMax *= 1.6
        @lengthMin *= 1.6
        @lengthMax *= 1.6
        @volumeMin *= 3.6
        @volumeMax *= 3.6

        @UPGRADES
        {
            @UPGRADE,*
            {
                @diameterMin *= 1.6
                @diameterMax *= 1.6
                @lengthMin *= 1.6
                @lengthMax *= 1.6
                @volumeMin *= 3.6
                @volumeMax *= 3.6
            }
        }
        @TECHLIMIT,*
        {
            @diameterMin *= 1.6
            @diameterMax *= 1.6
            @lengthMin *= 1.6
            @lengthMax *= 1.6
            @volumeMin *= 3.6
            @volumeMax *= 3.6
        }        
    }
    @MODULE[ProceduralSRB]
    {
        @thrust1m *= 2.56
    }
}
